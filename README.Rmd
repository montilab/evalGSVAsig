---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# evalGSVAsig

<!-- badges: start -->
<!-- badges: end -->

The goal of evalGSVAsig is to identify which genes are contributing most to a GSVA score.

## Installation

You can install the development version of evalGSVAsig from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("lkroeh/evalGSVAsig")
```

## Example

This is a basic example which shows the format of the data:

```{r example, eval=FALSE, message=FALSE, warnings=FALSE }
library(evalGSVAsig)

## example gene list
sig <- c("GENE1", "GENE2", "GENE3")
signature_list <- c(list(sig))
names(signature_list) <- c("signature1")

## run function
<<<<<<< HEAD
output <- evalGSVAsig::omics_signature_heatmap(eset = eset, signature = signature_list)

## view output
## df of genes ordered by correlation to signature score
print(output$score_cor)

## df of samples ordered by signature score
print(output$sig_score)

#show heatmap of ALL gene expression in relation to GSVA score
print(output$heatmap_all_genes)

#show heatmap of SIGNATURE gene expression in relation to GSVA score
print(output$heatmap_sig_genes)
=======
output <- evalGSVAsig::GSVAsignatureRanking(eset, signature_list)

## view output

## show sample specific signature score
print(output$sig_score)

## show genes' correlation to signature score
print(output$score_cor)

## show heatmap of ALL gene expression in relation to GSVA score
output$heatmap_all_genes

#show heatmap of SIGNATURE gene expression in relation to GSVA score
output$heatmap_sig_genes
>>>>>>> 2600d3946e751a76bea5c3d9f2823eddbb6f6ab0
```

With sample data:

```{r plots, message=FALSE, warning=FALSE, results='hide' }
#with our sample data
data(signatures)
data(eset)

output <- evalGSVAsig::omics_signature_heatmap(
  eset = eset, 
  signature = signatures, 
  metacol = ComplexHeatmap::HeatmapAnnotation( 
    df = pData(eset) |> dplyr::select(hpv_status),
    col = list(pheno = c(pos = "pink", neg = "gray"))))
```

View tables:

```{r tables}
## Show some of the genes' correlation to the signature score
print(head(output$score_cor))
## Show some of the signature scores
print(head(output$sig_score))
```

View heatmap that plots all signature and non-signature genes:

```{r full.heatmap, dpi=300}
print(output$heatmap_all_genes)
```

View heatmap that plots only signature genes:

```{r sig.heatmap, dpi=300}
print(output$heatmap_sig_genes)
```

